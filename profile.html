<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sanfiat Technologies - Profile</title>
    <meta name="description" content="Sanfiat Technologies offers top-notch products and services advertising.">
    <meta property="og:title" content="Sanfiat Technologies">
    <meta property="og:description" content="Leading provider of products and services advertisment.">
    <meta property="og:image" content=images/Photo_1723191951676.png">
    <meta property="og:url" content="https://www.sanfiat-technologies.com">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="dashboard.css">
    <link rel="icon" href="images/Photo_1723191951676.png" type="image/x-icon">
    </head>
    <header>
    <a href="index.html">
        <img id="logo" src="images/Photo_1723191951676.png" alt="Logo">
    </a>
      <div class="notification-icon">
    <a href="notifications.html">
        <i class="fas fa-bell" style="font-size: 30px;"></i>
        <span class="notification-count" id="notification-count">1</span>
    </a>
</div>
<button id="hamburger-icon" class="hamburger-menu">
    <i class="fas fa-bars" style="font-size: 30px;"></i>
</button>
        <nav id="mobile-nav" class="mobile-nav">
           <a href="index.html">
        <img id="logo" src="images/Photo_1723191951676.png" alt="Logo">
           </a>
    <h3>Main Categories</h3>
<a href="dashboard.html" class="has-submenu">
    <i class="fas fa-tachometer-alt"></i> Dashboard
</a>

<a href="packages.html" class="has-submenu">
    <i class="fas fa-box-open"></i> Packages
</a>
<div class="submenu">
    <a href="packages.html"><i class="fas fa-box"></i> Basic</a>
    <a href="packages.html"><i class="fas fa-boxes"></i> Premium</a>
</div>

<a href="deposit.html" class="has-submenu">
    <i class="fas fa-wallet"></i> Deposit
</a>
<div class="submenu">
    <a href="deposit.html"><i class="fas fa-mobile-alt"></i> MPESA</a>
    <a href="deposit.html"><i class="fab fa-paypal"></i> PayPal</a>
</div>

<a href="withdraw.html" class="has-submenu">
    <i class="fas fa-hand-holding-usd"></i> Withdraw
</a>
<div class="submenu">
    <a href="withdrawal.html"><i class="fas fa-mobile-alt"></i> MPESA</a>
    <a href="withdrawal.html"><i class="fas fa-university"></i> Bank Transfer</a>
</div>
            

<h3>Other Categories</h3>
<a href="products.html">
    <i class="fas fa-box"></i> Products
</a>
<a href="whatsapp-earnings.html">
    <i class="fab fa-whatsapp"></i> WhatsApp Earnings
</a>
<a href="bonuses.html">
    <i class="fas fa-gift"></i> Bonuses
</a>
<a href="loans.html">
    <i class="fas fa-money-check-alt"></i> Loans
</a>
<a href="vip.html">
    <i class="fas fa-crown"></i> VIP
</a>
<a href="vvip.html">
    <i class="fas fa-gem"></i> VVIP
</a>
<a href="blog.html">
    <i class="fas fa-blog"></i> Blog
</a>
<a href="profile.html">
    <i class="fas fa-user"></i> Profile
</a>
<a href="notifications.html">
    <i class="fas fa-bell"></i> Notifications
</a>
<a href="reviews.html">
    <i class="fas fa-star"></i> Reviews
</a>
<button type="button" id="logout-button">
    <i class="fas fa-sign-out-alt"></i> Log Out
        </button>
        </nav>
 </header>
<body>
<div class="profile-container">
    <h2>User Profile</h2>
    <div class="profile-picture-section">
        <img id="user-profile-picture" src="default-pic.png" alt="Profile Picture">
        <button id="change-profile-pic-btn">Change Profile Picture</button>
        <input type="file" id="upload-user-profile-pic" style="display: none;">
    </div>

    <form id="user-profile-form">
        <div class="form-group" style="background-color: #f8d7da;">
            <div class="icon-container">
                <i class="fas fa-user"></i>
            </div>
            <label for="user-full-name">Full Name:</label>
            <span id="user-full-name" class="editable" contenteditable="true"></span>
        </div>
        <div class="form-group" style="background-color: #d1ecf1;">
            <div class="icon-container">
                <i class="fas fa-envelope"></i>
            </div>
            <label for="user-email">Email:</label>
            <span id="user-email" class="editable" contenteditable="false"></span>
        </div>
        <div class="form-group" style="background-color: #fff3cd;">
            <div class="icon-container">
                <i class="fas fa-users"></i>
            </div>
            <label for="user-referral-count">Referral Count:</label>
            <span id="user-referral-count" class="editable" contenteditable="false"></span>
        </div>
        <div class="form-group" style="background-color: #d4edda;">
            <div class="icon-container">
                <i class="fas fa-eye"></i>
            </div>
            <label for="user-total-views">Total Views:</label>
            <span id="user-total-views" class="editable" contenteditable="false"></span>
        </div>
        <div class="form-group" style="background-color: #cce5ff;">
            <div class="icon-container">
                <i class="fas fa-dollar-sign"></i>
            </div>
            <label for="user-total-earnings">Total Earnings:</label>
            <span id="user-total-earnings" class="editable" contenteditable="false"></span>
        </div>
        <div class="form-group" style="background-color: #f8d7da;">
            <div class="icon-container">
                <i class="fas fa-money-bill-wave"></i>
            </div>
            <label for="user-amount-paid">Amount Paid:</label>
            <span id="user-amount-paid" class="editable" contenteditable="false"></span>
        </div>
        <div class="form-group" style="background-color: #d1ecf1;">
            <div class="icon-container">
                <i class="fas fa-gift"></i>
            </div>
            <label for="user-package-status">Package Status:</label>
            <span id="user-package-status" class="editable" contenteditable="false"></span>
        </div>
        <button type="button" id="save-user-profile-btn">Save Changes</button>
    </form>
</div>
    
        <section id="referral-link-section">
    <section id="referral-link-section">
    <h3>Your Referral Link</h3>
    <div class="referral-container">
        <p id="referral-link" class="referral-link"></p>
        <button id="copy-link-button">Copy Link</button>
    </div>
    <a id="whatsapp-share-button" href="#" target="_blank" aria-label="Share on WhatsApp">
    <i class="fab fa-whatsapp" style="font-size: 30px; color: #25D366;"></i>
    Share on WhatsApp
    </a>
    
</section>

<section id="referrals-section">
    <h3>Referred Users</h3>
    <ul id="referral-list">
        <!-- Referred users will be listed here -->
    </ul>
</section>

    <footer>
    <div class="footer">
        <div class="footer-item">
            <a href="dashboard.html">
                <i class="fas fa-home footer-icon"></i>
                <span>Home</span>
            </a>
        </div>
        <div class="footer-item">
            <a href="deposit.html">
                <i class="fas fa-money-bill-alt footer-icon"></i> <!-- Changed to a money icon for deposit -->
                <span>Deposit</span>
            </a>
        </div>
        <div class="footer-item">
            <a href="packages.html">
                <i class="fas fa-box-open footer-icon"></i> <!-- Changed to a box open icon for packages -->
                <span>Packages</span>
            </a>
        </div>
        <div class="footer-item">
            <a href="dashboard.html">
                <i class="fas fa-tachometer-alt footer-icon"></i>
                <span>Dashboard</span>
            </a>
        </div>
        <div class="footer-item">
            <a href="profile.html">
                <i class="fas fa-user-circle footer-icon"></i> <!-- Changed to a user circle icon for profile -->
                <span>Profile</span>
            </a>
        </div>
    </div>
    
    <div class="Button">
        <a href="deposit.html">
            <p class="post-btn">
                <i class="fa fa-plus-square"></i>
            </p>
        </a>
    </div>
    </footer>
    <script>
        // Assuming you have initialized Firebase and Firestore
const db = firebase.firestore();
const auth = firebase.auth();

// Function to fetch and display user data
const fetchUserProfile = async (userId) => {
    try {
        const userDocRef = db.collection('users').doc(userId);
        const userSnapshot = await userDocRef.get();

        if (userSnapshot.exists) {
            const userData = userSnapshot.data();
            // Populate profile fields with user data
            document.getElementById('user-full-name').textContent = userData.fullName || 'No name';
            document.getElementById('user-email').textContent = userData.email || 'No email';
            document.getElementById('user-referral-count').textContent = userData.referralCount || 0;
            document.getElementById('user-total-views').textContent = userData.totalViews || 0;
            document.getElementById('user-total-earnings').textContent = userData.totalEarnings || 0;
            document.getElementById('user-amount-paid').textContent = userData.amountPaid || 0;
            document.getElementById('user-package-status').textContent = userData.packageStatus || 'No active package';
        } else {
            console.log('No user data found in Firestore.');
        }
    } catch (error) {
        console.error('Error fetching user profile:', error);
    }
};

// Function to save updated user data
const saveUserProfile = async (userId) => {
    try {
        const userDocRef = db.collection('users').doc(userId);
        const updatedData = {
            fullName: document.getElementById('user-full-name').textContent,
            // Email, referral count, total views, etc. remain unchanged as they're not editable
            // If needed to change, make respective fields editable
        };

        await userDocRef.update(updatedData);
        console.log('User profile updated successfully.');
        alert('Profile updated successfully.');
    } catch (error) {
        console.error('Error updating user profile:', error);
    }
};

// Event listener for saving profile changes
document.getElementById('save-user-profile-btn').addEventListener('click', async () => {
    const user = auth.currentUser;
    if (user) {
        await saveUserProfile(user.uid);
    } else {
        alert('User not logged in.');
    }
});

// Fetch user profile data on page load
auth.onAuthStateChanged(async (user) => {
    if (user) {
        await fetchUserProfile(user.uid);
    } else {
        console.log('User not logged in.');
        // Redirect to login page or show login section if needed
    }
});

// Optional: Handle profile picture upload (if needed)
document.getElementById('change-profile-pic-btn').addEventListener('click', () => {
    document.getElementById('upload-user-profile-pic').click();
});

document.getElementById('upload-user-profile-pic').addEventListener('change', async (event) => {
    const file = event.target.files[0];
    if (file) {
        const user = auth.currentUser;
        const storageRef = firebase.storage().ref();

        // Upload profile picture
        const profilePicRef = storageRef.child(`profile_pictures/${user.uid}.jpg`);
        await profilePicRef.put(file);

        // Get the download URL
        const downloadURL = await profilePicRef.getDownloadURL();
        
        // Update user's profile picture URL in Firestore
        const userDocRef = db.collection('users').doc(user.uid);
        await userDocRef.update({ profilePicture: downloadURL });
        
        // Update the displayed profile picture
        document.getElementById('user-profile-picture').src = downloadURL;
        alert('Profile picture updated successfully.');
    }
});
            </script>

    <p class="copyright-text">&copy; 2024 Sanfiat Technologies. All rights reserved.</p>
<script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-storage.js"></script>
    
    <!-- Your custom script using Firebase -->
    <script type="module" src="script.js"></script>
</body>
</html>
