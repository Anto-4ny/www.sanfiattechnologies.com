<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sanfiat Technologies - My Dashboard</title>
    <meta name="description" content="Sanfiat Technologies offers top-notch products and services advertising.">
    <meta property="og:title" content="Sanfiat Technologies">
    <meta property="og:description" content="Leading provider of products and services advertisment.">
    <meta property="og:image" content=images/Photo_1723191951676.png">
    <meta property="og:url" content="https://www.sanfiat-technologies.com">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="dashboard.css">
    <link rel="icon" href="images/Photo_1723191951676.png" type="image/x-icon">
<style>
    /* Style for the pop-up modal */
.popup {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8); /* Semi-transparent background */
    display: flex;
    justify-content: center;
    align-items: center;
     z-index: 1000; 
}

.popup-content {
    background-color: #fff;
    padding: 20px;
    border-radius: 8px;
    text-align: center;
    width: 100%;
    max-width: 400px;
    box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
}

.activate-btn, .pay-btn {
    background-color: #28a745;
    color: #fff;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    margin-top: 10px;
}

.activate-btn:hover, .pay-btn:hover {
    background-color: #218838;
}

input {
    width: 100%;
    padding: 10px;
    margin: 10px 0;
    border-radius: 4px;
    border: 1px solid #ccc;
}
    </style>
</head>
<header>
  <a href="index.html">
    <img id="logo" src="images/Photo_1723191951676.png" alt="Logo">
  </a>

  <div class="notification-icon">
    <a href="notifications.html">
      <i class="fas fa-bell"></i>
      <span class="notification-count" id="notification-count">1</span>
    </a>
  </div>

  <div class="profile-icon">
    <a href="profile.html">
      <i class="fas fa-user-circle"></i>
    </a>
  </div>

  <button id="hamburger-icon" class="hamburger-menu">
    <i class="fas fa-bars"></i>
  </button>
</header>

<div id="overlay"></div>

<nav id="mobile-nav" class="mobile-nav">
  <h3>Browse Sanfiat</h3>
  <a href="dashboard.html"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
  <a href="#" class="has-submenu"><i class="fab fa-whatsapp"></i> Earn WhatsApp</a>
  <div class="submenu">
    <a href="packages.html"><i class="fas fa-box"></i> Purchase Packages</a>
    <a href="product.html"><i class="fas fa-box"></i> Download WhatsApp Product</a>
    <a href="upload.html"><i class="fas fa-boxes"></i> Screenshot Upload</a>
    <a href="whatsapp-earnings.html"><i class="fab fa-whatsapp"></i> WhatsApp Earnings</a>
  </div>
  <a href="deposit.html"><i class="fas fa-wallet"></i> Deposit</a>
  <a href="withdrawal.html"><i class="fas fa-hand-holding-usd"></i> Withdraw Earnings</a>
  <h3>More Goodies</h3>
  <a href="#" class="has-submenu"><i class="fas fa-gift"></i> Bonuses</a>
    <div class="submenu">
    <a href="welcome-bonuses.html"><i class="fas fa-gift"></i> Welcome Bonus</a>
    <a href="cashback-bonuses.html"><i class="fas fa-coins"></i> Cashback Bonus</a>
    </div>
  <a href="#" class="has-submenu"><i class="fas fa-money-check-alt"></i> Loans</a>
  <div class="submenu">
    <a href="short.html"><i class="fas fa-box"></i> Short-Term Loan</a>
    <a href="long.html"><i class="fas fa-boxes"></i> Long-Term Loan</a>
  </div>
    
  <a href="profile.html"><i class="fas fa-user"></i> Profile</a>
  <button type="button" id="logout-button"><i class="fas fa-sign-out-alt"></i> Log Out</button>
</nav>

            
    <body>
<!--<div id="payment-popup" class="popup"> 
    <div class="popup-content">
        <h2>Activate Your Account</h2>
        <p>Your account needs to be activated to access all features.</p>
        <button id="activate-btn" class="activate-btn">Activate Account</button>
        <div id="payment-section" class="payment-section" style="display: none;">
            <label for="phone-number">Enter your MPESA Number:</label>
            <input type="text" id="phone-number" placeholder="07XXXXXXXX" required pattern="^07\d{8}$">
            <label for="amount">Amount:</label>
            <input type="text" id="amount" value="250" readonly>
            <button id="pay-btn" class="pay-btn">Pay Now</button>
        </div>
    </div>
</div>-->

<section id="dashboard">
            <div id="dashboard-section">
                <section class="dashboard-welcome-box">
                    <h1>Welcome back <span id="firstName"></span>ðŸ’°</h1>
                        <!-- Notification Bar -->
<div id="notification-bar">
    Cashback Offers Activated Successfully: Purchase Standard package @2,800 Receive 5,600KES Cashback, Purchase Ultimate package @6,000 Receive 12,000KES Cashback bonus. All Cashbacks are instant!
    <span class="close-btn" id="close-notification">&times;</span>
</div>
               <h2>Dashboard</h2>     
                </section>
                
<section id="user-info">
    <div class="info-box" id="name-box">
        <p> Name: <span id="firstName"></span></p>
        <i class="fas fa-user"></i>
        <div class="progress-bar" id="name-progress"></div>
    </div>
    <div class="info-box" id="email-box">
        <p>Email: <span id="user-email"></span></p>
        <i class="fas fa-envelope"></i>
        <div class="progress-bar" id="email-progress"></div>
    </div>
    <div class="info-box" id="referral-box">
        <p>Referrals: <span id="referral-count"></span></p>
        <i class="fas fa-user-friends"></i>
        <div class="progress-bar" id="referral-progress"></div>
    </div>
    <div class="info-box" id="views-box">
        <p>Total Views: <span id="total-views"></span></p>
        <i class="fas fa-eye"></i>
        <div class="progress-bar" id="views-progress"></div>
    </div>
    <div class="info-box" id="earnings-box">
        <p>Total Earnings: <span id="total-earnings"></span> Ksh</p>
        <i class="fas fa-money-bill-wave"></i>
        <div class="progress-bar" id="earnings-progress"></div>
    </div>
    <div class="info-box" id="amount-box">
        <p>Amount Deposited: <span id="amount-paid">0</span> Ksh</p>
        <i class="fas fa-wallet"></i>
        <div class="progress-bar" id="amount-progress"></div>
    </div>
    <div class="info-box" id="package-box">
        <p>Packages: <span id="package-status"></span></p>
        <i class="fas fa-box-open"></i>
        <div class="progress-bar" id="package-progress"></div>
    </div>
    <!-- Loading Spinner -->
<div id="loading" style="display: none;">
    <div class="spinner"></div>
</div>
    
</section>
                
<section id="referral-link-section" style="margin: 20px auto; padding: 20px; max-width: 600px; background-color: #f9f9f9; border: 1px solid #ddd; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);">
    <h3>Your Referral Link</h3>
    <div class="referral-container" style="display: flex; align-items: center; justify-content: space-between; margin-top: 10px;">
        <p id="referral-link" class="referral-link" style="font-size: 14px; color: #333; background-color: #fff; padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 70%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
            https://example.com/referral-link
        </p>
        <button id="copy-link-button" style="background-color: #4caf50; color: white; border: none; border-radius: 4px; padding: 8px 12px; font-size: 14px; cursor: pointer; transition: background-color 0.3s;" 
        onmouseover="this.style.backgroundColor='#45a049'" 
        onmouseout="this.style.backgroundColor='#4caf50'">
            Copy Link
        </button>
    </div>
    <a id="whatsapp-share-button" href="#" target="_blank" aria-label="Share on WhatsApp" style="display: flex; align-items: center; margin-top: 15px; text-decoration: none; font-size: 16px;">
        <i class="fab fa-whatsapp" style="font-size: 30px; color: #25D366; margin-right: 10px;"></i>
        Share on WhatsApp
    </a>
</section>

<section id="referrals-section" style="margin: 20px auto; padding: 20px; max-width: 600px; background-color: #f9f9f9; border: 1px solid #ddd; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);">
    <h3 style="font-size: 18px; color: #333; margin-bottom: 10px;">Referred Users</h3>
    <ul id="referral-list" style="list-style-type: none; padding: 0; margin: 0;">
        <li style="font-size: 14px; color: #555; padding: 10px; margin-bottom: 5px; border: 1px solid #ddd; border-radius: 4px; background-color: #fff; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);">
            <span>sanfiat@gmail.com</span>
            <i class="fas fa-user referral-icon" style="font-size: 16px; color: #555;"></i>
        </li>
        <li style="font-size: 14px; color: #555; padding: 10px; margin-bottom: 5px; border: 1px solid #ddd; border-radius: 4px; background-color: #fff; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);">
            <span>sanfiattech@gmail.com</span>
            <i class="fas fa-user referral-icon" style="font-size: 16px; color: #555;"></i>
        </li>
        <!-- Add more referred users here -->
    </ul>
</section>

<footer>
    <div class="footer">
        <div class="footer-item">
            <a href="dashboard.html">
                <i class="fas fa-home footer-icon"></i>
                <span>Home</span>
            </a>
        </div>
        <div class="footer-item">
            <a href="deposit.html">
                <i class="fas fa-money-bill-alt footer-icon"></i> 
                <span>Deposit</span>
            </a>
        </div>
        <div class="footer-item">
            <a href="packages.html">
                <i class="fas fa-box-open footer-icon"></i> 
                <span>Packages</span>
            </a>
        </div>
        <div class="footer-item">
            <a href="dashboard.html">
                <i class="fas fa-tachometer-alt footer-icon"></i>
                <span>Dashboard</span>
            </a>
        </div>
        <div class="footer-item">
            <a href="profile.html">
                <i class="fas fa-user-circle footer-icon"></i> 
                <span>Profile</span>
            </a>
        </div>
    </div>
    
    <div class="Button">
        <a href="deposit.html">
            <p class="post-btn">
                <i class="fa fa-plus-square"></i>
            </p>
        </a>
    </div>
</footer>
                
                
        <script>
        // Function to check if the user has paid
const checkUserPaymentStatus = async () => {
    const userId = localStorage.getItem('userId');  // Assuming userId is stored after login
    if (!userId) return false;  // No user logged in

    const userDoc = await firestore.collection('users').doc(userId).get();
    if (userDoc.exists && userDoc.data().paymentStatus) {
        return true;  // User has paid
    } else {
        return false;  // User has not paid
    }
};

// Redirect user based on payment status
document.addEventListener('DOMContentLoaded', async () => {
    const hasPaid = await checkUserPaymentStatus();
    if (!hasPaid) {
        showPaymentPopup();
    }
});

// Function to show the payment popup
const showPaymentPopup = () => {
    const popup = document.getElementById('payment-popup');
    popup.style.display = 'block';
    
    // Hide the payment section initially
    const paymentSection = document.getElementById('payment-section');
    paymentSection.style.display = 'none';

    // Show the payment section and pay button after clicking "Activate Account"
    const activateButton = document.getElementById('activate-btn');
    activateButton.addEventListener('click', () => {
        paymentSection.style.display = 'block';
    });

    // Handle pay button click and initiate MPESA payment
    const payButton = document.getElementById('pay-btn');
    payButton.addEventListener('click', () => {
        const phoneNumber = document.getElementById('phone-number').value.trim();
        if (phoneNumber.match(/^07\d{8}$/)) {
            initiatePayment(phoneNumber);
        } else {
            alert("Please enter a valid MPESA phone number (07XXXXXXXX).");
        }
    });
};

// Function to initiate payment process
const initiatePayment = (phoneNumber) => {
    fetch('/api/pay', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ phoneNumber })
    })
    .then(response => response.json())
    .then(data => {
        alert(data.message);
    })
    .catch(error => console.error("Payment Error:", error));
};

    </script>
    
        <p class="copyright-text">&copy; 2024 Sanfiat Technologies. All rights reserved.</p>
<script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-storage.js"></script>
    
    <!-- Your custom script using Firebase -->
    <script type="module" src="script.js"></script>
</body>
</html>
